<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions and repeatability • compbio2020</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Functions and repeatability">
<meta property="og:description" content="compbio2020">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compbio2020</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/00_Syllabus_and_Expectations.html">Syllabus</a>
    </li>
    <li>
      <a href="../articles/01_Getting_Started_with_R.html">Starting with R</a>
    </li>
    <li>
      <a href="../articles/02_Starting_with_Data.html">Starting with data</a>
    </li>
    <li>
      <a href="../articles/03_Manipulating_Data.html">Manipulating, analyzing and exporting data with tidyverse</a>
    </li>
    <li>
      <a href="../articles/04-plotting.html">Data visualization with ggplot2</a>
    </li>
    <li>
      <a href="../articles/05_Functions.html">Functions and repeatability</a>
    </li>
    <li>
      <a href="../articles/06_Exploration_Setup.html">Exploration</a>
    </li>
    <li>
      <a href="../articles/06_Project_Structuring.html">Project Structuring</a>
    </li>
    <li>
      <a href="../articles/08_linear_models.html">Introduction to Linear Models: Building and Interpreting Linear Regressions</a>
    </li>
    <li>
      <a href="../articles/09_Tree_of_life.html">GeneticData</a>
    </li>
    <li>
      <a href="../articles/10_GBIF_and_Location.html">GBIF And Spatial Data</a>
    </li>
    <li>
      <a href="../articles/11_iNEXT.html">Camera Trap Data Analysis</a>
    </li>
    <li>
      <a href="../articles/HomeworkFive.html">Homework Five</a>
    </li>
    <li>
      <a href="../articles/HomeworkSix.html">HomeworkSix</a>
    </li>
    <li>
      <a href="../articles/Simulation.html">Simulations</a>
    </li>
    <li>
      <a href="../articles/bonus_tables.html">Tables.Rmd</a>
    </li>
    <li>
      <a href="../articles/homework_0.html">How to Do Homework</a>
    </li>
    <li>
      <a href="../articles/homework_1.html">Homework One</a>
    </li>
    <li>
      <a href="../articles/homework_2.html">Homework Two</a>
    </li>
    <li>
      <a href="../articles/homework_3.html">Homework Three</a>
    </li>
    <li>
      <a href="../articles/homework_4.html">Homework Four</a>
    </li>
    <li>
      <a href="../articles/homework_5.html">Homework Five: Functions</a>
    </li>
    <li>
      <a href="../articles/homework_6.html">HomeworkSix.Rmd</a>
    </li>
    <li>
      <a href="../articles/homework_7.html">HomeworkSix</a>
    </li>
    <li>
      <a href="../articles/project_final.html">Project: Final</a>
    </li>
    <li>
      <a href="../articles/project_one.html">ProjectOne</a>
    </li>
    <li>
      <a href="../articles/project_three.html">ProjectThree</a>
    </li>
    <li>
      <a href="../articles/project_two.html">Project Two</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Functions and repeatability</h1>
                        <h4 data-toc-skip class="author">April Wright;
Borrows heavily from Ethan White’s semester long biology course</h4>
            
      
      
      <div class="hidden name"><code>05_Functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.2 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.4.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 1.0.2</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.2.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.1.3</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.3.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.5.0</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 1.0.0</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"data/portal_data_joined.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">34786</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">13</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (6): species_id, sex, genus, species, taxa, plot_type</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (7): record_id, month, day, year, plot_id, hindfoot_length, weight</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="section level3">
<h3 id="functions-enable-repeatability">Functions enable repeatability<a class="anchor" aria-label="anchor" href="#functions-enable-repeatability"></a>
</h3>
<ul>
<li>How many of you have done something so far in the semester, and then
forgotten it later? Let’s discuss how to make code more permenant,
reusable and readable
<ul>
<li>Informative variable names</li>
<li>Consistent indentation and line spacing</li>
<li>Good commenting</li>
<li>Functions</li>
</ul>
</li>
<li>Write reusable code.
<ul>
<li>Concise and modular script</li>
<li>Functions with general structure</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="understandable-chunks">Understandable chunks<a class="anchor" aria-label="anchor" href="#understandable-chunks"></a>
</h3>
<ul>
<li>Human brain can only hold ~7 things in memory at a given time.
<ul>
<li>Write programs that don’t require remembering more than ~7 things at
once.</li>
</ul>
</li>
<li>What do you know about how <code>sum(1:5)</code> works internally?
<ul>
<li>Nothing.</li>
<li>What do you think it does?</li>
<li>Test your idea. Were you right?</li>
</ul>
</li>
<li>All functions should work as a single conceptual chunk, labeled in a
logical way so that you don’t have to remember what it does.</li>
</ul>
</div>
<div class="section level3">
<h3 id="reuse">Reuse<a class="anchor" aria-label="anchor" href="#reuse"></a>
</h3>
<ul>
<li>Want to do the same thing repeatedly?
<ul>
<li>Inefficient &amp; error prone to copy code</li>
<li>Even worse to rewrite it every time!</li>
<li>If it occurs in more than one place, it will eventually be wrong
somewhere.</li>
</ul>
</li>
<li>Functions are written to be reusable.</li>
</ul>
</div>
<div class="section level3">
<h3 id="function-basics">Function basics<a class="anchor" aria-label="anchor" href="#function-basics"></a>
</h3>
<pre><code><span><span class="va">function_name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output_value</span> <span class="op">&lt;-</span> <span class="fu">do_something</span><span class="op">(</span><span class="va">inputs</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output_value</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<pre><code><span><span class="va">calc_shrub_vol</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">volume</span> <span class="op">&lt;-</span> <span class="va">length</span> <span class="op">*</span> <span class="va">width</span> <span class="op">*</span> <span class="va">height</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">volume</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<ul>
<li>Creating a function doesn’t run it.</li>
<li>Call the function with some arguments.</li>
</ul>
<pre><code><span><span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.0</span><span class="op">)</span></span>
<span><span class="va">shrub_vol</span> <span class="op">&lt;-</span> <span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.0</span><span class="op">)</span></span></code></pre>
<ul>
<li>Walk through function execution (using debugger)
<ul>
<li>Call function</li>
<li>Assign 0.8 to length, 1.6 to width, and 2.0 to height inside
function</li>
<li>Calculate volume</li>
<li>Send the volume back as output</li>
<li>Store it in <code>shrub_vol</code>
</li>
</ul>
</li>
<li>Treat functions like a black box.
<ul>
<li>Can’t access a variable that was created in a function
<ul>
<li><code>&gt; width</code></li>
<li><code>Error: object 'width' not found</code></li>
</ul>
</li>
<li>‘Global’ variables can influence function, but should not.
<ul>
<li>Very confusing and error prone to use a variable that isn’t passed
in as an argument</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="exercise">Exercise:<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h2>
<blockquote>
<p>Type the name of a function that we have already used in class to
view the source code of the function. Can you tell what the expected
inputs and outputs of the function are?</p>
</blockquote>
<div class="section level3">
<h3 id="default-arguments">Default arguments<a class="anchor" aria-label="anchor" href="#default-arguments"></a>
</h3>
<ul>
<li>Defaults can be set for common inputs.</li>
</ul>
<pre><code><span><span class="va">calc_shrub_vol</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">length</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">width</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">height</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">volume</span> <span class="op">&lt;-</span> <span class="va">length</span> <span class="op">*</span> <span class="va">width</span> <span class="op">*</span> <span class="va">height</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">volume</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">calc_shrub_vol</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.0</span><span class="op">)</span></span>
<span><span class="fu">calc_shrub_vol</span><span class="op">(</span>height <span class="op">=</span> <span class="fl">2.0</span>, length <span class="op">=</span> <span class="fl">0.8</span>, width <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="named-vs-unnamed-arguments">Named vs unnamed arguments<a class="anchor" aria-label="anchor" href="#named-vs-unnamed-arguments"></a>
</h3>
<ul>
<li>When to use or not use argument names</li>
</ul>
<pre><code><span><span class="fu">calc_shrub_vol</span><span class="op">(</span>height <span class="op">=</span> <span class="fl">2.0</span>, length <span class="op">=</span> <span class="fl">0.8</span>, width <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span></code></pre>
<p>Or</p>
<pre><code><span><span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="fl">2.0</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span><span class="op">)</span></span></code></pre>
<ul>
<li>You can always use names
<ul>
<li>Value gets assigned to variable of that name</li>
<li>Remember the 7 things we can hold in memory?</li>
</ul>
</li>
<li>If not using names then order determines naming
<ul>
<li>First value is <code>height</code>, second value is
<code>length</code>…</li>
<li>If order is hard to remember use names</li>
</ul>
</li>
<li>In many cases there are <em>a lot</em> of optional arguments
<ul>
<li>Convention to always name optional argument</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="combining-functions">Combining Functions<a class="anchor" aria-label="anchor" href="#combining-functions"></a>
</h3>
<ul>
<li><p>Each function should be single conceptual chunk of code</p></li>
<li><p>Functions can be combined to do larger tasks in two ways</p></li>
<li><p>Calling multiple functions in a row</p></li>
</ul>
<pre><code><span><span class="va">est_shrub_mass</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">volume</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">2.65</span> <span class="op">*</span> <span class="va">volume</span><span class="op">^</span><span class="fl">0.9</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">shrub_mass</span> <span class="op">&lt;-</span> <span class="fu">est_shrub_mass</span><span class="op">(</span><span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">shrub_mass</span> <span class="op">&lt;-</span> <span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">est_shrub_mass</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<ul>
<li>Calling functions from inside other functions</li>
<li>Allows organizing function calls into logical groups</li>
</ul>
<pre><code><span><span class="va">est_shrub_mass_dim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">volume</span> <span class="op">=</span> <span class="fu">calc_shrub_vol</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span></span>
<span>  <span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu">est_shrub_mass</span><span class="op">(</span><span class="va">volume</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">est_shrub_mass_dim</span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.0</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="consistency">Consistency<a class="anchor" aria-label="anchor" href="#consistency"></a>
</h2>
<p>We ran into some trouble Tuesday. I had defined each of my functions
a couple times. And in so doing, I ended up with extra arguments to some
functions and none to others.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calc_vol</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">len</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">width</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">height</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">volume</span> <span class="op">&lt;-</span> <span class="va">len</span> <span class="op">*</span> <span class="va">width</span> <span class="op">*</span> <span class="va">height</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">volume</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">calc_mass</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vol</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">2.65</span> <span class="op">*</span> <span class="va">vol</span><span class="op">^</span><span class="fl">.9</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">calc_den</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">len</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">vol</span> <span class="op">&lt;-</span>  <span class="fu">calc_vol</span><span class="op">(</span><span class="va">len</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span></span>
<span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu">calc_mass</span><span class="op">(</span><span class="va">len</span><span class="op">)</span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">mass</span><span class="op">/</span><span class="va">vol</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">calc_den</span><span class="op">(</span>len <span class="op">=</span> <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">4</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2060448</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="more-complex-functions">More complex functions<a class="anchor" aria-label="anchor" href="#more-complex-functions"></a>
</h2>
<p>So far, we’ve looked at situations where we are providing one or a
few arguments to a function. But what about situations where we want to
be able to use functions to process our data in more complex ways?</p>
<p>We may want to select data from a data frame inside a function. We
can do that like so:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remove_nas</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">clean</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span></span>
<span>   <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">clean</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">remove_nas</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 30,676 × 1</span></span></span>
<span><span class="co">##    weight</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>    204</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>    199</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    197</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    166</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>    184</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>    206</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>    274</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>    186</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>    184</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     87</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 30,666 more rows</span></span></span></code></pre>
<p>But is this a good thing? This function will allow us to select one
and only one column. We call this practice <em>hardcoding</em>. It makes
our code inflexible - what if we want other data? We would have to edit
the code itself. In general, we want to make as few changes to our code
as possible. Every change introduces the chance to make a mistake.</p>
<p>So, we can change our code a little bit to make it more flexible. We
can, for example, make it so that the user tells the function what code
they want. We do this by placing the column in the function body in
curly braces. This tells R to prepare to accept user input. See the
below:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remove_nas</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">column</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">clean</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">column</span><span class="op">}</span><span class="op">}</span><span class="op">)</span></span>
<span>   <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">clean</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">remove_nas</span><span class="op">(</span><span class="va">surveys</span>, <span class="va">hindfoot_length</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 30,676 × 1</span></span></span>
<span><span class="co">##    hindfoot_length</span></span>
<span><span class="co">##              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>              32</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>              34</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>              32</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>              33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>              32</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>              32</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>              33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>              30</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>              33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>              31</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 30,666 more rows</span></span></span></code></pre>
<p>After you have run the above, you will see that we can now choose a
column based on what we provide in the function call. Very handy!</p>
</div>
<div class="section level2">
<h2 id="exercise-1">Exercise:<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h2>
<blockquote>
<p>We may want multiple columns of data. How can we make a function
flexible to multiple columns? There are two possible solutions to this
issue. Look at each of the below and see if you can figure out how they
work. Discuss with a partner the pros and cons of each solution.</p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Solution One</span></span>
<span><span class="va">remove_nas</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">column</span>, <span class="va">column1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">clean</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">column</span><span class="op">}</span><span class="op">}</span>, <span class="op">{</span><span class="op">{</span><span class="va">column1</span><span class="op">}</span><span class="op">}</span><span class="op">)</span></span>
<span>   <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">clean</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">remove_nas</span><span class="op">(</span><span class="va">surveys</span>, <span class="va">hindfoot_length</span>, <span class="va">weight</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 30,676 × 2</span></span></span>
<span><span class="co">##    hindfoot_length weight</span></span>
<span><span class="co">##              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>              32    204</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>              34    199</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>              32    197</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>              33    166</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>              32    184</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>              32    206</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>              33    274</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>              30    186</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>              33    184</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>              31     87</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 30,666 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Solution Two</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hindfoot_length"</span>, <span class="st">"weight"</span><span class="op">)</span></span>
<span><span class="va">remove_nas</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">columns</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">clean</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">columns</span><span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">clean</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h2>
<ul>
<li>How can we know what we’ve done is good?</li>
<li>How could you verify that a number is right?
<ul>
<li>What about our density? What must be true of it?</li>
<li>Generic vs. specific</li>
</ul>
</li>
<li>What about non-numerics?
<ul>
<li>Write some function to clean data.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="functions-from-class">Functions from class<a class="anchor" aria-label="anchor" href="#functions-from-class"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calc_density</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">volume</span> <span class="op">&lt;-</span> <span class="fu">calc_vol</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span></span>
<span>  <span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu">calc_mass</span><span class="op">(</span><span class="va">volume</span><span class="op">)</span></span>
<span>  <span class="va">density</span> <span class="op">&lt;-</span> <span class="va">mass</span><span class="op">/</span><span class="va">volume</span> </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">density</span> <span class="op">&lt;</span> <span class="va">volume</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Density impossibly large! Check your math."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">calc_density</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">volume</span> <span class="op">&lt;-</span> <span class="fu">calc_vol</span><span class="op">(</span><span class="va">length</span>, <span class="va">width</span>, <span class="va">height</span><span class="op">)</span></span>
<span>  <span class="va">mass</span> <span class="op">&lt;-</span> <span class="fu">calc_mass</span><span class="op">(</span><span class="va">volume</span><span class="op">)</span></span>
<span>  <span class="va">density</span> <span class="op">&lt;-</span> <span class="va">mass</span><span class="op">/</span><span class="va">volume</span> </span>
<span>  <span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">density</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">is.double</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Density impossibly large! Check your math."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data_cleaning</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span></span>
<span>  <span class="va">data_clean</span> <span class="op">&lt;-</span> <span class="va">data_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d_c</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">data_clean</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"NAs still present!"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span> </span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by April Wright.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
